---
title: "The permutation group and order of operations"
author: "Robin K. S. Hankin"
date: "`r Sys.Date()`"
vignette: >
  %\VignetteIndexEntry{order_of_ops}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

Order of operations can be confusing when considering permutation
groups.  Here I discuss active and passive transforms, order of
operations, prefix and postfix notation, and associativity from a
computational perspective.

Consider the following

```{r}
library("permutations")
library("magrittr")
options("print_word_as_cycle" = FALSE)
a <- as.cycle("(145)(26)")
names(a) <- NULL
a
```

Thus we can see that $a$ has a two-cycle $(145)$ and a three-cycle
$(26)$.  We can express $a$ in word form:

```{r}
(a <- as.word(a))
```

showing that 3 is a fixed point.  In matrix form we would have:

\[
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
4&6&3&5&1&2
\end{array}
\right)
\]

Expressed in functional notation, we have a function $a\colon
[6]\longrightarrow [6]$ (here $[n]=\left\{1,2,\ldots,n\right\}$); and
we have $a(1)=4$, $a(2)=5$, $a(3)=3$, and so on.  If these were
people, we might want to keep track of where the people are.  We would
say: "at the start, person $i$ sits in place $i$, $i\in[6]$.  Then,
after the move, person 1 is in place 4, person 2 in place 5, person 3
in place 3, and so on".  This information is encapsulated by
```as.word(a)```.  In R matrix form we would have

```{r}
a1 <- rbind(1:6,as.word(a))
rownames(a1) <- c("person","place")
a1
```

(in the above R chunk, note how the top row---the *person*---is
```1:6```).  On the other hand, we might be more interested in the
*places*.  We might want to know who is sitting in place 4.  We would
say: "at the start, person $i$ sits in place $i$, $i\in[6]$.  Then
place 1 is occupied by person 4, place 2 occupied by person 5, and so
on".  This information is technically represented by permutation
```a``` but in an obscure form.  To answer the question "who is in
place $i$?" we need to rearrange the permutation:

\[
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
4&6&3&5&1&2
\end{array}
\right)
{\mbox{swap rows}\atop\longrightarrow}
\left(
\begin{array}{ccccccccc}
4&6&3&5&1&2\\
1&2&3&4&5&6
\end{array}
\right){\mbox{shuffle columns}\atop\longrightarrow}
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
5&6&3&1&4&2
\end{array}
\right)
\]

In the above, it is easy to see that the rearrangement of permutation is equivalent to taking a group-theoretic inverse:

```{r}
inverse(a)
```

(even now I find the R idiom for inversion to be unreasonably elegant:
```a[a] <- seq_along(a)```).  In R idiom, the two-row matrix form
would use ```inverse()```:

```{r}
a2 <- rbind(1:6,as.word(inverse(a)))
rownames(a2) <- c("place","person")
a2
```

(in the above R chunk, note how the top row---the *place*---is
```1:6```).  If the people subsequently move again, the mathematics
and the R idiom depend on whether we are interested in people, or
places.  We need to specify use of *active* or *passive*
transformations, much as in the Lorentz package.

### Active permutations

An active permutation $\pi$ moves a person from place $i$ to place
$\pi(i)$.  This is the usual case, and is used above.

### Passive permutations

A passive permutation $\pi$ replaces a person in position $i$ by that
in position $\pi(i)$.


## Composition of active permutations


Suppose we have permutation ```a``` as above, and another permutation
```b```:

```{r}
b <- as.word(c(5, 2, 3, 4, 6, 1))
b
```

(note the three dots representing three fixed points of ```b```).
What is the result of executing $a$, followed by $b$?  Symbolically:


\[
\overbrace{
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
4&6&3&5&1&2
\end{array}
\right)
}^{a}
\circ
\overbrace{
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
5&2&3&4&6&1\\
\end{array}
\right)
}^{b}=
\overbrace{
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
4&1&3&6&5&2\\
\end{array}
\right)
}^{a\circ b}
\]

Thus, for example, $4\longrightarrow 5\longrightarrow 6$.  Note
carefully that the operations $a,b$ do not commute and we will discuss
this later in the context of active and passive transforms.
Considering the operation $a\circ b$, this means that we perform
permutation ```a``` first, and then perform permutation ```b```.
Taking this one step at a time we would have, for example: "the person
in place 4 (this is person 4) moves to place 5 $\ldots$ and then the
person in place 5 (this is person 4) moves to place 6".  See how we
track the person in place 4 over two permutations, and person 4 ends
up in place 6.


In R we would have

```{r}
a*b
```

The ```*``` operator in R idiom is essentially carries out ```b[a]```
to evaluate ```a*b``` (which is why indexing starts at 1, not 0).
Indeed we may verify that idiom operates as expected:

```{r}
as.vector(b)[as.vector(a)]
```

With functional notation (also known as prefix notation) we can ask
what happens to the person in place 1:

```{r}
fa <- as.function(a)
fb <- as.function(b)
fb(fa(1))
as.function(a*b)(1)
```

Note the confusing order of operations: in functional notation, if we
want to operate on an element $x$ by function $f$ and then by function
$g$ we write $g(f(x))$ for the two successive mappings
$x\longrightarrow f(x)\longrightarrow g(f(x))$.  Postfix notation
would denote the same process as $xfg$, as shorthand for $(xf)g$.  In
R idiom, this is implemented by the excellent magrittr package:

```{r}
1 %>% fa %>% fb
```


# Composition of passive permutations

Now we consider the same operations ```a``` and ```b``` as discussed
above, but from the perspective of places, rather than people.  First
we look at ```a```

```{r}
a   # word form 
a1  # matrix form (active)
a2  # matrix form (passive)
```

and then ```b```, but we need to create equivalents ```b1``` and
```b2``` which we do as before:

```{r}
b
b1 <- rbind(1:6,as.word(b))
rownames(b1) <- c("person","place")
b1
b2 <- rbind(1:6,as.word(inverse(b)))
rownames(b2) <- c("place","person")
b2
```


If we execute ```a``` and then ```b``` using active language need to
use standard permutation composition, using the ```*``` operator:

```{r}
a*b
```

However, using passive

\[
\overbrace{
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
5&2&3&4&6&1\\
\end{array}
\right)
}^{b}
\circ
\overbrace{
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
4&6&3&5&1&2\\
\end{array}
\right)
}^{a}=
\overbrace{
\left(
\begin{array}{ccccccccc}
1&2&3&4&5&6\\
1&6&3&5&2&4\\
\end{array}
\right)
}^{b\circ a}
\]




https://en.wikiversity.org/wiki/Permutation_notation
